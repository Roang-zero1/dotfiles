# WARNING: Do not edit this file.
# It was generated by processing {{ yadm.source }}

source ~/.zinit/bin/zinit.zsh

zinit light zdharma-continuum/zinit-annex-patch-dl

zinit light-mode for \
  zdharma-continuum/zinit-annex-bin-gem-node

zinit ice lucid
zinit snippet OMZP::common-aliases

zinit wait lucid for \
  OMZP::extract

ZSH_ALIAS_FINDER_AUTOMATIC=true

# Install fd from github
zinit wait"1" lucid from"gh-r" as"null" for \
    mv"fd* -> fd" sbin"**/fd" @sharkdp/fd \
    sbin"**/bat"              @sharkdp/bat \
    sbin"bin/exa* -> exa"     ogham/exa \
    sbin"fzf"                 junegunn/fzf

if type "fd" >> /dev/null; then
  _fzf_compgen_path() {
    fd --hidden --follow --exclude ".git" . "$1"
  }

  _fzf_compgen_dir() {
    fd --type d --hidden --follow --exclude ".git" . "$1"
  }
fi

zinit ice wait lucid
zinit snippet https://raw.githubusercontent.com/junegunn/fzf/master/shell/key-bindings.zsh

zinit light "zlsun/solarized-man"

# Compatibility fix direnv <> tmux
if [ -n "$TMUX" ] && [ -n "$DIRENV_DIR" ]; then
  unset ${(Mk)parameters:#DIRENV*}  # unset env vars starting with DIRENV_
fi
# Install direnv from GitHub
zinit wait lucid from"gh-r" as"null" mv"direnv* -> direnv" \
    atclone'./direnv hook zsh > zhook.zsh' atpull'%atclone' \
    sbin"direnv" src="zhook.zsh" for \
        direnv/direnv

zinit wait lucid as'null' atinit'export PYENV_ROOT="$PWD"' \
    atclone'PYENV_ROOT="$PWD" ./libexec/pyenv init - > zpyenv.zsh' \
    atpull"%atclone" src"zpyenv.zsh" nocompile'!' sbin"bin/pyenv" for \
        pyenv/pyenv

zinit ice as"none" sbin"code_connect.py -> code" nocompile
zinit snippet https://raw.githubusercontent.com/chvolkmann/code-connect/main/bin/code_connect.py

zinit wait lucid \
  pick"misc/quitcd/quitcd.bash_zsh" \
  sbin make"O_NERD=1 O_GITSTATUS=1 O_NAMEFIRST=1" \
  atpull"%atclone" atclone"cd ${XDG_CONFIG_HOME:-$HOME/.config}/nnn/plugins && curl -Ls https://raw.githubusercontent.com/jarun/nnn/master/plugins/getplugs | sh" \
  for \
  jarun/nnn

zinit ice pip'git+https://github.com/powerline/powerline.git@develop' as"none" id-as"powerline" sbin"venv/bin/powerline" sbin"venv/bin/powerline-config" sbin"venv/bin/powerline-daemon" sbin"venv/bin/powerline-render" sbin"venv/bin/powerline-lint"
zinit load zdharma-continuum/null

zinit light "chrissicool/zsh-256color"

# Improvements for git
zinit ice atload"path+=( \$PWD/bin )"
zinit light wfxr/forgit
zinit ice as"null" from"gh-r" mv"delta* -> delta" sbin"delta/delta -> delta"
zinit light dandavison/delta

zinit ice as"command" from"gh-r" \
          atclone"./starship init zsh > init.zsh; ./starship completions zsh > _starship" \
          atpull"%atclone" src"init.zsh"
zinit light starship/starship

zinit wait lucid for \
  is-snippet  ~/.zsh/aliases.zsh \
  is-snippet  ~/.zsh/bindkeys.zsh


if (( $+commands[carapace] )) ; then
  zinit ice wait lucid atclone"carapace _carapace > carapace-generated.zsh" nocompile pick"carapace-generated.zsh" id-as"carapace"
  zinit load zdharma-continuum/null
else
  if [[ ! -e "$HOME/.zsh/IGNORE_MISSING_CARAPACE" ]]; then
    echo "\033[0;31m'carapace' binary is missing, install it (https://github.com/rsteube/carapace-bin), or silence this warning with \`touch ~/.zsh/IGNORE_MISSING_CARAPACE\`"
  fi
fi

zinit wait lucid for \
  light-mode "Aloxaf/fzf-tab" \
  atinit"ZINIT[COMPINIT_OPTS]=-C; zicompinit; zicdreplay" \
    zdharma-continuum/fast-syntax-highlighting \
  blockf \
    zsh-users/zsh-completions \
  atload"!_zsh_autosuggest_start" \
    zsh-users/zsh-autosuggestions\
  as-id"yadm" as"completion" \
    is-snippet https://raw.githubusercontent.com/TheLocehiliosan/yadm/master/completion/zsh/_yadm

unalias fd 2>/dev/null

# Update history settings to provide larger shared history
HISTFILE=~/.zhistory
HISTSIZE=SAVEHIST=5000
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_REDUCE_BLANKS
setopt incappendhistory
setopt sharehistory
setopt extendedhistory

# Change autosuggestions colour
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE=fg=4
ZSH_AUTOSUGGEST_BUFFER_MAX_SIZE=20
ZSH_AUTOSUGGEST_USE_ASYNC=True
ZSH_AUTOSUGGEST_STRATEGY=(history completion)

zinit pack for dircolors-material

zstyle ':completion:*:descriptions' format '[%d]'
zstyle ':fzf-tab:*' switch-group ',' '.'

typeset -U path

# Export for tmux
export EDITOR='vim'

# Load nnn config
[ -f "$HOME/.config/nnn/env.zsh" ] && source "$HOME/.config/nnn/env.zsh" || true

[ -d "$HOME/.yarn/bin" ] && path+=($HOME/.yarn/bin) || true
[ -d "$HOME/.local/bin" ] && path+=($HOME/.local/bin) || true
[ -d "$HOME/.poetry/bin" ] && path+=($HOME/.poetry/bin) || true
if [[ -n "$commands[pyenv]" ]]; then
  eval "$(pyenv init --path)"
  eval "$(pyenv init -)"
  if [ -d "$(pyenv root)/plugins/pyenv-virtualenv" ]; then
    eval "$(pyenv virtualenv-init -)"
  fi
fi
if [ -d "/usr/local/go" ]; then
  export GOROOT=/usr/local/go
  export GOPATH=$HOME/go
  path+=($GOROOT/bin)
  path+=($GOPATH/bin)
fi

{% if yadm.distro == "alpine" %}
alias poweroff='doas /sbin/poweroff'
{% endif %}

{% if yadm.hostname == "canopus.uberspace.de" %}
path=($HOME/.toast/armed/bin/zsh $path)
path+=(/package/host/localhost/nodejs-5/bin $path)
path+=($HOME/.composer/vendor/bin)
path+=(~/.gem/ruby/2.2.0/bin)
path+=(~/src/go/bin)
export MANPATH=$HOME/.toast/armed/share/man:/usr/local/share/man:/usr/share/man/overrides:/usr/share/man/en:/usr/share/man:/var/qmail/man>
export GOPATH=~/src/go
{% endif %}

