# WARNING: Do not edit this file.
# It was generated by processing {{ yadm.source }}

source ~/.zinit/bin/zinit.zsh

zinit light zdharma-continuum/zinit-annex-patch-dl

zinit light-mode for \
  zdharma-continuum/zinit-annex-bin-gem-node

zinit ice lucid
zinit snippet OMZP::common-aliases

zinit wait lucid for \
  OMZP::extract \
  OMZP::npm

ZSH_ALIAS_FINDER_AUTOMATIC=true

zinit lucid wait from"gh-r" as"completion" for \
    id-as"exa-c" mv"completions/exa.zsh -> _exa" pick"_exa" ogham/exa \
    id-as"bat-c" mv"**/autocomplete/bat.zsh -> _bat" pick"_bat"  @sharkdp/bat

# Install fd from github
zinit wait"1" lucid from"gh-r" as"null" for \
    mv"fd* -> fd" sbin"**/fd" @sharkdp/fd \
    sbin"**/bat"              @sharkdp/bat \
    sbin"bin/exa* -> exa"     ogham/exa \
    sbin"fzf"                 junegunn/fzf

if type "fd" >> /dev/null; then
  _fzf_compgen_path() {
    fd --hidden --follow --exclude ".git" . "$1"
  }

  _fzf_compgen_dir() {
    fd --type d --hidden --follow --exclude ".git" . "$1"
  }
fi

zinit lucid wait for \
  id-as"fzf-extra" \
  atclone"mv shell/completion.zsh _fzf" \
  pick"shell/completion.zsh" \
  src"shell/key-bindings.zsh" \
  junegunn/fzf


zinit light "Aloxaf/fzf-tab"

zinit light "zlsun/solarized-man"

zinit wait lucid atload"zicompinit; zicdreplay" for \
  zdharma-continuum/fast-syntax-highlighting \
  blockf \
  zsh-users/zsh-completions \
  atload"zpcdreplay" atclone'./zplug.zsh' \
  g-plane/zsh-yarn-autocompletions \
  atload"!_zsh_autosuggest_start" \
  zsh-users/zsh-autosuggestions

zinit ice as"completion"
zinit snippet https://github.com/docker/cli/blob/master/contrib/completion/zsh/_docker

# Install direnv from GitHub
zinit wait lucid from"gh-r" as"program" mv"direnv* -> direnv" \
    atclone'./direnv hook zsh > zhook.zsh' atpull'%atclone' \
    pick"direnv" src="zhook.zsh" for \
        direnv/direnv

zinit wait lucid as'null' atinit'export PYENV_ROOT="$PWD"' \
    atclone'PYENV_ROOT="$PWD" ./libexec/pyenv init - > zpyenv.zsh' \
    atpull"%atclone" src"zpyenv.zsh" nocompile'!' sbin"bin/pyenv" for \
        pyenv/pyenv

zinit light "chrissicool/zsh-256color"

# Improvements for git
zinit ice atload"path+=( \$PWD/bin )"
zinit load wfxr/forgit
zinit ice as"command" from"gh-r" mv"delta* -> delta" pick"delta/delta"
zinit light dandavison/delta

zinit ice pick"async.zsh"
zinit light "mafredri/zsh-async"

zinit ice depth"1" # git clone depth
zinit load "romkatv/powerlevel10k"

zinit wait lucid for \
  is-snippet  ~/.zsh/aliases.zsh \
  is-snippet  ~/.zsh/bindkeys.zsh

# Load Powerlevel 10k config
[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh

unalias fd 2>/dev/null

# Get hostname if environment variable is empty
if [ -z "$HOSTNAME" ]; then
  HOSTNAME=$(hostname)
fi

# Update history settings to provide larger shared history
HISTFILE=~/.zhistory
HISTSIZE=SAVEHIST=5000
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_REDUCE_BLANKS
setopt incappendhistory
setopt sharehistory
setopt extendedhistory

# Change autosuggestions colour
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE=fg=4
ZSH_AUTOSUGGEST_BUFFER_MAX_SIZE=20
ZSH_AUTOSUGGEST_USE_ASYNC=True
ZSH_AUTOSUGGEST_STRATEGY=(history completion)

zinit pack for dircolors-material

zstyle ':completion:*:descriptions' format '[%d]'
zstyle ':fzf-tab:*' switch-group ',' '.'

typeset -U path

# Export for tmux
export EDITOR='vim'

[ -d "$HOME/.yarn/bin" ] && path+=($HOME/.yarn/bin) || true
[ -d "$HOME/.local/bin" ] && path+=($HOME/.local/bin) || true
[ -d "$HOME/.poetry/bin" ] && path+=($HOME/.poetry/bin) || true
if [[ -n "$commands[pyenv]" ]]; then
  eval "$(pyenv init --path)"
  eval "$(pyenv init -)"
  if [ -d "$(pyenv root)/plugins/pyenv-virtualenv" ]; then
    eval "$(pyenv virtualenv-init -)"
  fi
fi
if [ -d "/usr/local/go" ]; then
  export GOROOT=/usr/local/go
  export GOPATH=$HOME/go
  path+=($GOROOT/bin)
  path+=($GOPATH/bin)
fi

{% if yadm.distro == "alpine" %}
alias poweroff='doas /sbin/poweroff'
{% endif %}

{% if yadm.hostname == "canopus.uberspace.de" %}
path=($HOME/.toast/armed/bin/zsh $path)
path+=(/package/host/localhost/nodejs-5/bin $path)
path+=($HOME/.composer/vendor/bin)
path+=(~/.gem/ruby/2.2.0/bin)
path+=(~/src/go/bin)
export MANPATH=$HOME/.toast/armed/share/man:/usr/local/share/man:/usr/share/man/overrides:/usr/share/man/en:/usr/share/man:/var/qmail/man>
export GOPATH=~/src/go
{% endif %}
